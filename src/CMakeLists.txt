# provides SQLCIPHER_INCLUDE_DIRS SQLCIPHER_LIBRARIES SQLCIPHER_LIBRARY_DIRS
find_package(SqlCipher REQUIRED)

# provides OPENSSL_INCLUDE_DIRS OPENSSL_LIBRARIES OPENSSL_LIBRARY_DIRS
find_package(OpenSSL REQUIRED)

file(GLOB_RECURSE SOURCES_FILES "*.c")

add_compile_definitions(SQLITE_HAS_CODEC $<$<STREQUAL:${CMAKE_TARGET_PLATFORM},Penguin>:_GNU_SOURCE>)

add_executable(pk ${SOURCES_FILES})

target_link_directories(pk PRIVATE ${SQLCIPHER_LIBRARY_DIRS} ${OPENSSL_LIBRARY_DIRS})

target_link_libraries(pk PRIVATE ${SQLCIPHER_LIBRARIES} ${OPENSSL_LIBRARIES})

target_include_directories(pk PUBLIC ${CMAKE_CURRENT_SOURCE_DIR} PRIVATE ${PROJECT_BINARY_DIR} ${SQLCIPHER_INCLUDE_DIRS} ${OPENSSL_INCLUDE_DIRS})

target_precompile_headers(pk PUBLIC "compat-util.h" PRIVATE [["project-config.h"]])

set_target_properties(pk PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR})